# Regularization parameter in the aeromagnetic data processing using differential operators

by
Janaína A. Melo


## About

The results generated by this program are presented in my Master's thesis: "Regularization parameter in the aeromagnetic data processing using differential operators."

This repository contains the source code to perform the synthetic test. The codes 'filtering.py', 'synthetic_data.py', and 'plot_figure.py' generate the results related to methodology.

These programs are compatible with both Python 2.7 and Python 3.7 programming language.


## Abstract

The evaluation of numerical derivatives is an essential tool in magnetic data processing, aiming to map structural lineaments and estimate the depth of the respective anomalous sources in the subsurface. Generally, directional derivatives are obtained through numerical methods based on the calculation of the Fourier transform, susceptible to noise amplification due to numerical instability. One way to improve stability in differentiation is to apply Tikhonov regularization to balance the oscillatory characteristics of the derivatives with the smoothing degree associated with the particular choice of regularization parameter. In this work, a graphical procedure is proposed to estimate regularization parameters for different potential field transformations that require first or second-order derivatives. This tool is based on the normalization of the L2-norm of the respective transformed fields to a sequence of trial regularization parameters, resulting in a characteristic function with a staircase format. This function has smooth and monotonic behavior, decreasing from 1 to 0 for increasing regularization values, in which the upper step (1) of the function is associated with non-regularized and sub-regularized transformations and the lower step (0) corresponds to over-regularized transformations. Synthetic tests simulating models with different noise levels or anomaly complexities illustrated that the well-suited selection of the regularization parameter in a characteristic interval can be associated with the properties of the processed transformed fields (presence or absence of distortions in the data) or with erroneous (overestimated) depth inferences. The applicability of the regularization procedure is evaluated on mesh aeromagnetic data covering two study areas in the Tocantins Province, central Brazil. In Area-I, covering the Anápolis-Itauçu Complex, transformations using first-order derivatives regularized with the intermediate ramp criterion were efficient in better mapping the continuity of magnetic lineaments with different directions and intersections, associated with shear zones, geological faults, and intrusive bodies. Applications in Area-II covering the Transbrasiliano tectonic corridor revealed the need for a low-dose regularization to obtain depth estimates consistent with the depths of the underlying basement of the Bananal Basin, according to available information from seismic lines and gravity models. Regularization tuned to the intermediate ramp criterion was sufficient for transformations with first-order derivatives to map the complex pattern of multiple linear structures. The results in Area-II showed that transformations based on second-order derivatives require a high degree of regularization to detect the contributions from subtle structural features.


## Content

- filtering.py:
	General Python module containing the functions to compute the non-regularized and 
        regularized directional higher-order derivatives, S-function of the regularized 
	directional higher-order derivatives, and regularization parameters.
	
- synthetic_data.py:
	Python script to generate the synthetic results. The script loads the total-field 
	anomaly of a synthetic model from the file "synthetic_data.dat" and computes the 
	S-function of the regularized higher-order derivatives, regularization parameters, 
	and non-regularized and regularized higher-order derivatives using the functions 
	in "filtering.py". The figures are generated using the function "plot_figure.py".

- plot_figure.py:
	Python script to generate the figures of the synthetic data.
	
Test data:

- synthetic_data.dat:
		Synthetic total-field anomaly data are available by Uieda et al. (2014) at 
		http://github.com/pinga-lab/paper-tle-euler-tutorial.	

Complementary files:

- batholith_vertices: 
		x and y coordinates of the batholith vertices to plot on synthetic data 
                figures.

- dike_vertices: 
		x and y coordinates of the dike vertices to plot on synthetic data 
		figures.

- sill_vertices: 
		x and y coordinates of the sill vertices to plot on synthetic data 
		figures.


## Getting the code

You can download a copy of all the files in this repository by cloning the
[git](https://git-scm.com/) repository:

    git clone https://github.com/janainaanjos/Staircase_Function_Higher_Order_Derivatives.git

or [download a zip archive](https://github.com/janainaanjos/Staircase_Function_Higher_Order_Derivatives/archive/master.zip).


## Dependencies

The Python program "filtering.py" requires the Python packages "numpy" and "sklearn", the 
script "synthetic_data.py" requires the Python package "numpy", and the script "plot_figure.py" 
requires the Python packages "numpy" and "matplotlib". The easier way to get Python and all libraries 
installed is through the Anaconda Python distribution (https://www.anaconda.com/distribution/). After 
installed Anaconda, install the libraries by running the following command in your terminal:

	conda install numpy matplotlib sklearn


## Reproducing the results

For the synthetic data, the figures are found in the folder '/figures'. Running the code 'synthetic_data.py' 
will allow the reproduction of the results of my methodology. For more information read the file 'README.md'
or 'README.txt' in the folder '/code'.


## License

All source code is made available under a MIT license. You can freely use 
and modify the code, without warranty, so long as you provide attribution
to the authors. See 'LICENSE.md' for the full license text.

The thesis text is open source. The author reserves the right to the thesis 
content.
